<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>Wochenansicht</title>
    <link rel="stylesheet" href="css/navbarStyle.css">
    <link rel="stylesheet" href="css/weeklyViewStyle.css">
</head>
<header>
    <div class="navbar">

        <a href="StartPage.html" class="left-icon">
            <img src="pictures/clock.png" alt="clock-icon" class="left-icon" title="Rückkehr zu Startseite"></a>

    

    <div class="nav-buttons">

        <a href="Monthly-View.html"><button class="nav-button" onclick="setActive(this)">Monatsansicht</button></a>
        <a href="WeeklyView.html"><button class="nav-button active" onclick="setActive(this)">Wochenansicht</button></a> 
        <a href="Daily-View.html"><button class="nav-button " onclick="setActive(this)">Tagesansicht</button></a>          

    </div>

<div class="right-icons">
    <a href="Termin_erstellen.html" class="right-icons">
        <img src="pictures/appo.png" alt="Termine" class="icon" title="Termine bearbeiten"></a>
        <a href="Erinnerung_bearbeiten.html" class="right-icons">
        <img src="pictures/bell.webp" alt="Erinnerungen" class="icon" title="Erinnerungen bearbeiten"></a>
</div>

</div>

<div>
    <h1>&nbsp;</h1>
</div>

<script>
    function setActive(button) {
        document.querySelectorAll('.nav-button').forEach(btn => btn.classList.remove('active'));
        button.classList.add('active');
    }
</script>
</header>

<body>
    <!--Anabell-->
        <br><br>
    <!--Pseudocode 
    1. Box öffnen-->
    <article>
        <div id="uhrzeit">
            <!--2.Live-Uhrezit oben (11:00:04)--> 
                    <h1 id="uhrzeit"></h1>
                    <script>
                        function updateUhrzeit() {
                            const jetzt = new Date();
                            
                            // Uhrzeit
                            const stunden = jetzt.getHours().toString().padStart(2, '0');
                            const minuten = jetzt.getMinutes().toString().padStart(2, '0');
                            const sekunden = jetzt.getSeconds().toString().padStart(2, '0');
                            const uhrzeitText = `${stunden}:${minuten}:${sekunden}`;
                            
                            // Monat als Text
                            const monate = [
                                "Januar", "Februar", "März", "April", "Mai", "Juni",
                                "Juli", "August", "September", "Oktober", "November", "Dezember"
                            ];
                            const tag = jetzt.getDate().toString().padStart(2, '0');
                            const monat = monate[jetzt.getMonth()];  // Monat in Textform
                            const jahr = jetzt.getFullYear();
                            const datumText = `${tag}. ${monat} ${jahr}`;
                            
                            // Anzeige von Uhrzeit und Datum
                            document.getElementById('uhrzeit').innerHTML = `<span style="font-size: 38px;">${uhrzeitText}</span><br>
                                <span style="font-size: 20px; color: grey;">${datumText}</span>`;
                        }
                        
                        setInterval(updateUhrzeit, 1000);
                        
                        updateUhrzeit();
                    </script>
            
            <!--3. Heutiges Datum (Mittwoch,12. Februar 2025)-->
                </div>
    
        <div>
    
    <!--Dropdown Menü Monats wechseln (Januar-Dezember, nur eins auswählbar)-->
    <table>
        <tr>
            <th style="text-align: left;">
                Kalenderwoche
                <select id="weekSelect">
                    <!-- Optionen für Kalenderwochen werden dynamisch generiert -->
                </select>
            </th>
            <th style="width: 50px; font-size: medium;">
                <input type="number" id="yearInput" value="2025" style="width: 60px;">
            </th>
        </tr>
    </table>
</div>

<!-- Tabelle für die Wochenansicht -->
<table id="calendarTable" class="kalender">
    <tr>
        <th>KW</th>
        <th>Mo</th>
        <th>Di</th>
        <th>Mi</th>
        <th>Do</th>
        <th>Fr</th>
        <th>Sa</th>
        <th>So</th>
    </tr>
</table>
</article>

<script>
// Funktion zur Berechnung der Tage einer Kalenderwoche
function getWeekDates(year, week) {
    const firstDayOfYear = new Date(year, 0, 1);
    const daysToFirstMonday = (8 - firstDayOfYear.getDay()) % 7;
    const firstMonday = new Date(year, 0, 1 + daysToFirstMonday);
    const startDate = new Date(firstMonday.setDate(firstMonday.getDate() + (week - 1) * 7));
    const weekDates = [];

    for (let i = 0; i < 7; i++) {
        const currentDate = new Date(startDate);
        currentDate.setDate(startDate.getDate() + i);
        weekDates.push(currentDate);
    }

    return weekDates;
}

// generierung der Wochenansicht
function generateWeekView(year, week) {
    const table = document.getElementById('calendarTable');
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }

    const weekDates = getWeekDates(year, week);
    const row = table.insertRow();
    const weekNumberCell = row.insertCell();
    weekNumberCell.textContent = week;
    weekNumberCell.style.backgroundColor = '#cccccc5f';

    weekDates.forEach(date => {
        const cell = row.insertCell();
        cell.textContent = date.getDate();
        if (date.getDay() === 0 || date.getDay() === 6) {
            cell.style.backgroundColor = '#cccccc5f'; 
        }
    });
}

// Dropdown-Menü für Kalenderwochen füllen
function populateWeekSelect() {
    const weekSelect = document.getElementById('weekSelect');
    for (let i = 1; i <= 52; i++) {
        const option = document.createElement('option');
        option.value = i;
        option.textContent = `KW ${i}`;
        weekSelect.appendChild(option);
    }
}


document.getElementById('weekSelect').addEventListener('change', function() {
    const week = parseInt(this.value);
    const year = parseInt(document.getElementById('yearInput').value);
    generateWeekView(year, week);
});

document.getElementById('yearInput').addEventListener('change', function() {
    const week = parseInt(document.getElementById('weekSelect').value);
    const year = parseInt(this.value);
    generateWeekView(year, week);
});


populateWeekSelect();
const currentDate = new Date();
const currentWeek = getWeekNumber(currentDate);
document.getElementById('weekSelect').value = currentWeek;
document.getElementById('yearInput').value = currentDate.getFullYear();
generateWeekView(currentDate.getFullYear(), currentWeek);

// berechnung der Kalenderwoche
function getWeekNumber(date) {
    const firstDayOfYear = new Date(date.getFullYear(), 0, 1);
    const pastDaysOfYear = (date - firstDayOfYear) / 86400000;
    return Math.ceil((pastDaysOfYear + firstDayOfYear.getDay() + 1) / 7);
}
</script>

    
    <!--6. Box Schließen-->  
    </article>

    <div class="Termin" style="float: left; margin-left: 19.5%; width: 30%; font-size:small;">
        <table>
            <tr>
                <th>Placeholder</th>
            </tr>
            <tr>
                <td> &nbsp; Termintitel </td>
                <td> &nbsp; "Anzeige aus Datenbank Termintitel" </td>
            </tr>
            <tr>
                <td> &nbsp; Datum </td>
                <td> &nbsp; "hinterlegtes Datum aus der Datenbank " </td>
            </tr>
            <tr>
                <td> &nbsp; Uhrzeit </td>
                <td> &nbsp; "hinterlegtes Uhrzeit aus der Datenbank " </td>
            </tr>
            <tr>
                <td> &nbsp; Beschreibung </td>
                <td> &nbsp; "hinterlegte Beschreibung aus der Datenbank " </td>
            </tr>
        </table>
    </div>
    
    <div class="Erinnerungen" style="float: right; margin-right: 19.5%; width: 30%; font-size:small;">
        <table>
            <tr>
                <th>Placeholder</th>
            </tr>
            <tr>
                <td> &nbsp; Erinnerung </td>
                <td> &nbsp; "Anzeige aus Datenbank Termintitel" </td>
            </tr>
            <tr>
                <td> &nbsp; Datum </td>
                <td> &nbsp; "hinterlegtes Datum aus der Datenbank " </td>
            </tr>
            <tr>
                <td> &nbsp; Uhrzeit </td>
                <td> &nbsp; "hinterlegtes Uhrzeit aus der Datenbank " </td>
            </tr>
            <tr>
                <td> &nbsp; Beschreibung </td>
                <td> &nbsp; "hinterlegte Beschreibung aus der Datenbank " </td>
            </tr>
        </table>
    </div>


</html>